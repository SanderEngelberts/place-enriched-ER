# Utilizing linked open place data for entity resolution &mdash; a case study on Dutch genealogy at CBG
[Master's thesis](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/MSc_Thesis_report.pdf) in Applied Data Science at Utrecht University by Sander Engelberts, executed in April to June 2022<br> 
under primary supervision of prof. dr. A.H.L.M. Pieters, secondary supervision of S.B. Dirks MSc, and external supervision of P. Woltjer from the Dutch [Centre for Genealogy](https://cbg.nl/)<br>

**Abstract**: *Entity resolution on genealogical documents is challenging due to spelling errors, alternative name variants, and historic entity changes. Traditional methods attempt to tackle these problems with string similarity methods, which this research proposes to extend by enriching the recorded features with additional place information such as place URIs, coordinates, and country indicators. Based on a case study at the Dutch Centre for Genealogy, this research contributes to extending entity resolution research, optimizing and enriching family history (meta) studies, and investigating which privacy-sensitive passport request documents can be disclosed.* 

*First, linked open data sources are shown to retrieve unique place entities belonging to recorded place names. Second, place, province and country name similarities are calculated as well as coordinate distances within a coordinate reference system that limits the distance distortions for the respective countries. Third, the researched adaptation is shown to result in a significant change in similarity values when a uniform weighting of feature similarities is applied. However, contrary to the hypothesis, the similarity distributions of compared documents that do and do not refer to an equivalent person entity could not be distinguished in a more accurate way. Hence, future studies are proposed that expand on this research by supervised learning of weights and thresholds using validated candidate links from this research.*

**Keywords**: *Entity resolution, Linked open data, Genealogy, Geospatial data, Content similarity*

For questions or remarks, please contact [s.engelberts@students.uu.nl](mailto:s.engelberts@students.uu.nl)<br>

## Repository
Below the paths to code- and other files in the [repository](https://github.com/SanderEngelberts/place-enriched-ER) can be found together with a description about what these entail. Note that no files with data or previews of it are included within (the code of) this [repository](https://github.com/SanderEngelberts/place-enriched-ER) because these contain privacy sensitive information. For being granted access to these files, make a request at the Dutch [Centre for Genealogy](https://cbg.nl/).

| Path | Description
| :--- | :----------
| [place-enriched-ER](https://github.com/SanderEngelberts/place-enriched-ER) | Main repository.
| &ensp;&ensp;&boxvr;&nbsp; [README.md](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/README.md) | This ReadMe giving information about the project and [repository](https://github.com/SanderEngelberts/place-enriched-ER).
| &ensp;&ensp;&boxvr;&nbsp; [LICENSE](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/LICENSE) | AGPL-3.0 License with copyright to Sander Engelberts.
| &ensp;&ensp;&boxvr;&nbsp; [MSc_Thesis_report.pdf](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/MSc_Thesis_report.pdf) | Report of the MSc thesis research corresponding to this [repository](https://github.com/SanderEngelberts/place-enriched-ER).
| &ensp;&ensp;&boxvr;&nbsp; [requirements.txt](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/requirements.txt) | File with code to install all required packages and their dependencies for executing all code in this [repository](https://github.com/SanderEngelberts/place-enriched-ER). Here is also mentioned which package versions were used during development, without guarantees that the code runs with different versions.
| &ensp;&ensp;&boxvr;&nbsp; [Data_exploration_cleaning.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Data_exploration_cleaning.ipynb) | First notebook which inspects and cleans the original CBG personal record cards and passport requests data sets, and explores the cleaned versions. This ensures that more place entities can be retrieved from linked open data sources, features and their missing values are standardised, and frequency balances of features are explored. 
| &ensp;&ensp;&boxvr;&nbsp; [Location_matching_against_Wikidata.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Location_matching_against_Wikidata.ipynb) | Second notebook which queries Wikidata for place entities and their features using the cleaned, unique place-province name combinations in personal record cards and passport requests (from [Data_exploration_cleaning.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Data_exploration_cleaning.ipynb)). This ensures that the data can get enriched with place information: Wikidata URI, GeoNames URI, centroid coordinates, standard and alternative names, country name and URI, and administrative region name and URI.
| &ensp;&ensp;&boxvr;&nbsp; [Location_matching_with_ErfGeo_Proxy.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Location_matching_with_ErfGeo_Proxy.ipynb) | Third notebook which queries ErfGeo for place entities and their features using the cleaned, unique place-province name combinations in personal record cards and passport requests (from [Data_exploration_cleaning.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Data_exploration_cleaning.ipynb)) that could not be resolved using Wikidata in [Location_matching_against_Wikidata.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Location_matching_against_Wikidata.ipynb), and combines the results from Wikidata and ErfGeo. This ensures that more data can get enriched with place information: GeoNames URI, centroid coordinates, and alternative names. 
| &ensp;&ensp;&boxvr;&nbsp; [Entity_resolution.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Entity_resolution.ipynb) | Fourth notebook which first processes the cleaned data sets of personal record cards and passport requests (from [Data_exploration_cleaning.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Data_exploration_cleaning.ipynb)) into the final entity resolution input by standardising the feature names, aggregating retrieved LOD place entity data (from [Location_matching_with_ErfGeo_Proxy.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Location_matching_with_ErfGeo_Proxy.ipynb)) into existing features of records (and consequently dropping the records that could not be enriched), creating a blocking key for each record and only keeping the records that have minimum one candidate. Second, the designed entity resolution algorithm is run for non- and place enriched data, which takes into account (partially) missing feature values. Last, the resulting outputs are inspected with respect to their similarity value distributions and validated using a stratified random sample of candidate links as well as matches against BRP records of deceased people.
| &ensp;&ensp;&boxvr;&nbsp; [Data_exploration-non_place_enriched.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Data_exploration-non_place_enriched.ipynb) | Fifth notebook which explores the non-place enriched personal record cards and passport requests data that was used as input for the entity resolution algorithm in [Entity_resolution.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Entity_resolution.ipynb). Hence, this entails only a subset of the cleaned records for which candidates and a place entity retrieved from LOD sources exist, as subsetted by [Entity_resolution.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Entity_resolution.ipynb).
| &ensp;&ensp;&boxur;&nbsp; [Data_exploration-place_enriched.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Data_exploration-place_enriched.ipynb) | Sixth notebook which explores the place enriched personal record cards and passport requests data that was used as input for the entity resolution algorithm in [Entity_resolution.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Entity_resolution.ipynb). Hence, this entails only a subset of the cleaned records for which candidates and a place entity retrieved from LOD sources exist, as subsetted and aggregated into this data by [Entity_resolution.ipynb](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/Entity_resolution.ipynb).

## Requirements
* Windows 10 is used during creation of this [repository](https://github.com/SanderEngelberts/place-enriched-ER), but also other operation systems should be supported
* A device with Intel(R) Core(TM) i7-7500U CPU and 8GB RAM was used for smoothly running the code of this [repository](https://github.com/SanderEngelberts/place-enriched-ER). Further, 1GB of storage space was required to store the original data sets, intermediate results and the final results
* Python 3.7.11 installed as stated in [requirements.txt](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/requirements.txt)
* Other Python libraries installed using Pip 21.0.1 as described in [requirements.txt](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/requirements.txt). Alternatively, a program such as Anaconda3 can also be used for this

## Executing notebooks
When access to the personal record cards and passport requests data is granted by the Dutch [Centre for Genealogy](https://cbg.nl/), the results described in the 
[report](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/MSc_Thesis_report.pdf) corresponding to the code in this [repository](https://github.com/SanderEngelberts/place-enriched-ER) can be reproduced. With some adjustments in cleaning and structuring data to be in line with the code in this [repository](https://github.com/SanderEngelberts/place-enriched-ER), other data sets can also use the created place entity querying and entity resolution algorithms. With the original (or adapted, alternative) data sets the notebooks have to be executed in the order described in the repository overview section of this [ReadMe](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/README.md) (unless intermediate steps have already been run before), which can be done as explained in the [Jupyter Notebook documentation](https://docs.jupyter.org/en/latest/index.html).

## Future development
When an extension is whished to be made to the entity resolution algorithm of this research, its code can be easily adapted within the notebooks by adding or adjusting certain features or weight values. Note that this is a copyright implementation that can only be used or contributed to after explicit permission by [Sander Engelberts](mailto:s.engelberts@students.uu.nl).

Some interesting future features to implement are (as mostly also discussed in the corresponding [report](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/MSc_Thesis_report.pdf)):
* Developing a software package from the notebook files that can be directly used for interlinking multiple different collections based on specified features and similarity metrics. This release was specifically created for linking passport requests to personal record cards at CBG that refer to the same real-world people, so some adaptations are required for more flexible use of the entity resolution algorithm by data sets with different structures.
* Performing additional manual cleaning and lookup to retrieve more equivalent place entities or decide among multiple LOD query results, and to be able to utilize the retrieved administrative regions information from Wikidata. Additionally, different sources may be utilized to retrieve values for missing attributes using the unique place URIs.
* Experimenting with the use of a different blocking key when no or only few candidates were found, or when no equivalent entity was identified with the original blocking key. This to make sure this is not due to spelling errors or personal name changes. An example key can include different features such as (birth) dates and (birth) places.
* Supervised learning methods can best be used to learn optimal thresholds and weights for each feature similarity value. This in contrast to iterative manual
calibration and validation. Here then no normalization and distance/time period thresholds need to be taken into account, because the weights will take this into account. Optimized weights can then possibly still result in the hypothesized increased ability to correctly split the candidate links into non- and equivalent entities, in contrast to this study. As training and test data for this proposed procedure, manually validated candidate(s) (links) of this research can be used, taking into account class imbalances.
* As extension to standard supervised learning methods, Geographically Weighted Regression or other geospatial methods can be used to verify if spatial non-stationarity exists among feature similarity scores. If this is not the case, then a standard global model can be applied that determines if two entities are equivalent based on learned weights and thresholds. Otherwise, using such local geospatial methods, different weights and thresholds can be determined for
different regions or varying distances between place entities.
* Taking into account the frequency of (person or place) names can ensure that entities with less common names are considered more likely equivalent than ones with more common names.
* Different features that are not yet digitized in this data may further aid identifying equivalent entities, and make it possible to interlink documents of relatives that are mentioned on these records. This can be done in a similar fashion as this research, where the values of the feature are first matched against a LOD source to resolve name variations and enrich the data with additional attributes. In specific, Rahmani et al. (2014) and Rahmani et al. (2016) have shown that context similarity increases the ER accuracy, on which is elaborated in the [report](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/MSc_Thesis_report.pdf).
* Implementing a LOD ontology with time-dependent predicates for CBG would represent each document in all collections in a standardized format, which enriches the data through its relationships with other entities and allows for changes in features to reduce bias against (minority/oppressed) groups such as transgender people. This way, it is possible to infer new information about, for example, the siblings or grandparents of someone instead of only about their parents, children or partners that are directly mentioned in their records. Hence, in the future a full family tree can be easily inferred that refers to all documents related to each ancestor, and (meta) studies about geospatial aspects of families are facilitated. Moreover, the outputs of the entity resolution algorithm from this research can then also be represented in this LOD format by creating relationships between person entities and their related documents, on which is elaborated in the [report](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/MSc_Thesis_report.pdf).

## Acknowledgements
The implemented methods in this research build on top of the shoulders of researchers in the interesting fields of genealogy, entity resolution and linked open data. References to their works can thus also be found in the corresponding [report](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/MSc_Thesis_report.pdf). I firstly want to thank them very much for their contributions to science in these domains. Next I want to thank my Utrecht University supervisors Toine Pieters and Simon Dirks for our meetings and your written feedback. This helped me to make sure my thesis is scientifically relevant for and in the scope of a Applied Data Science master thesis at Utrecht University. Further, I am grateful to Pieter Woltjer for giving me the opportunity to perform this research at CBG and guide me with your domain experience in this interesting field. This showed me the practical relevance of my thesis and gave me interesting insights into the data and the workfield. Moreover, I want to thank Pieter Woltjer and Jeroen Balkenende for validating my results such that this could be done in an unbiased fashion by domain experts. And last but definitely not least, I want to thank my partner, family and friends for always being there for me to give support and for having interesting conversations on this topic.

## License
Copyright &copy; 2022, [Sander Engelberts](mailto:s.engelberts@students.uu.nl). All rights reserved.

This work is made available under the [GNU Affero General Public License v3.0 (AGPL-3.0 License)](https://github.com/SanderEngelberts/place-enriched-ER/blob/main/LICENSE).
